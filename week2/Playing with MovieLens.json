{"paragraphs":[{"text":"%md\n### Let's make sure Spark is working first!\nLet's see what version we're working with.","user":"anonymous","dateUpdated":"2023-02-01T22:16:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's make sure Spark is working first!</h3>\n<p>Let's see what version we're working with.</p>\n"}]},"apps":[],"jobName":"paragraph_1675289454876_-1811877540","id":"20230201-221054_1305984600","dateCreated":"2023-02-01T22:10:54+0000","dateStarted":"2023-02-01T22:16:34+0000","dateFinished":"2023-02-01T22:16:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1928"},{"text":"sc.version\n","user":"anonymous","dateUpdated":"2023-02-01T22:17:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1675289794019_1401066935","id":"20230201-221634_1515620111","dateCreated":"2023-02-01T22:16:34+0000","dateStarted":"2023-02-01T22:17:09+0000","dateFinished":"2023-02-01T22:18:26+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:1929"},{"text":"%sh\n\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\necho \"Downloaded!\"","user":"anonymous","dateUpdated":"2023-02-01T22:21:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2023-02-01 22:21:29--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 54.231.164.89, 52.217.83.196, 3.5.27.164, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|54.231.164.89|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  131K 15s\n    50K .......... .......... .......... .......... ..........  4%  465K 9s\n   100K .......... .......... .......... .......... ..........  7%  594K 7s\n   150K .......... .......... .......... .......... ..........  9% 8.14M 5s\n   200K .......... .......... .......... .......... .......... 12%  272K 5s\n   250K .......... .......... .......... .......... .......... 14% 12.4M 4s\n   300K .......... .......... .......... .......... .......... 17%  406M 4s\n   350K .......... .......... .......... .......... .......... 19% 60.7M 3s\n   400K .......... .......... .......... .......... .......... 22%  500K 3s\n   450K .......... .......... .......... .......... .......... 24%  524K 3s\n   500K .......... .......... .......... .......... .......... 27% 13.7M 3s\n   550K .......... .......... .......... .......... .......... 29%  386M 2s\n   600K .......... .......... .......... .......... .......... 32%  402M 2s\n   650K .......... .......... .......... .......... .......... 34%  354M 2s\n   700K .......... .......... .......... .......... .......... 36%  318M 2s\n   750K .......... .......... .......... .......... .......... 39%  338M 1s\n   800K .......... .......... .......... .......... .......... 41%  407M 1s\n   850K .......... .......... .......... .......... .......... 44%  555K 1s\n   900K .......... .......... .......... .......... .......... 46%  507K 1s\n   950K .......... .......... .......... .......... .......... 49%  247M 1s\n  1000K .......... .......... .......... .......... .......... 51%  152M 1s\n  1050K .......... .......... .......... .......... .......... 54% 12.4M 1s\n  1100K .......... .......... .......... .......... .......... 56% 31.3M 1s\n  1150K .......... .......... .......... .......... .......... 59% 27.1M 1s\n  1200K .......... .......... .......... .......... .......... 61% 71.7M 1s\n  1250K .......... .......... .......... .......... .......... 64%  112M 1s\n  1300K .......... .......... .......... .......... .......... 66% 53.5M 1s\n  1350K .......... .......... .......... .......... .......... 68%  400M 1s\n  1400K .......... .......... .......... .......... .......... 71%  129M 0s\n  1450K .......... .......... .......... .......... .......... 73% 76.8M 0s\n  1500K .......... .......... .......... .......... .......... 76%  422M 0s\n  1550K .......... .......... .......... .......... .......... 78%  478M 0s\n  1600K .......... .......... .......... .......... .......... 81% 9.48M 0s\n  1650K .......... .......... .......... .......... .......... 83%  378M 0s\n  1700K .......... .......... .......... .......... .......... 86% 1.98M 0s\n  1750K .......... .......... .......... .......... .......... 88% 28.5M 0s\n  1800K .......... .......... .......... .......... .......... 91% 1.01M 0s\n  1850K .......... .......... .......... .......... .......... 93%  565K 0s\n  1900K .......... .......... .......... .......... .......... 96% 3.03M 0s\n  1950K .......... .......... .......... .......... .......... 98% 97.8M 0s\n  2000K .......... .......... ..........                      100%  379M=1.4s\n\n2023-02-01 22:21:31 (1.46 MB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2023-02-01 22:21:31--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 54.231.164.89, 52.217.224.185, 3.5.21.123, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|54.231.164.89|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  130K 1s\n    50K .......... .......... .......... .......... .......... 43%  262K 1s\n   100K .......... .......... .......... .......... .......... 64% 98.8M 0s\n   150K .......... .......... .......... .......... .......... 86%  812K 0s\n   200K .......... .......... ..........                      100%  239K=0.8s\n\n2023-02-01 22:21:33 (301 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\nDownloaded!\n"}]},"apps":[],"jobName":"paragraph_1675289910902_-1546708927","id":"20230201-221830_1911806081","dateCreated":"2023-02-01T22:18:30+0000","dateStarted":"2023-02-01T22:21:28+0000","dateFinished":"2023-02-01T22:21:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1930"},{"text":"%sh\n\nhadoop fs -rm -r -f /tmp/ml-100k\n\nhadoop fs -mkdir /tmp/ml-100k\n\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/\n","user":"anonymous","dateUpdated":"2023-02-01T22:23:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1675290087564_-1756155703","id":"20230201-222127_1594358707","dateCreated":"2023-02-01T22:21:27+0000","dateStarted":"2023-02-01T22:23:09+0000","dateFinished":"2023-02-01T22:23:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1931"},{"text":"final case class Rating(movieID: Int, rating: Int)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x => {val fields = x.split(\"\\t\"); Rating(fields(1).toInt, fields(2).toInt)})","user":"anonymous","dateUpdated":"2023-02-01T22:28:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[2] at map at <console>:28\n"}]},"apps":[],"jobName":"paragraph_1675290188857_-1693872354","id":"20230201-222308_2033621334","dateCreated":"2023-02-01T22:23:08+0000","dateStarted":"2023-02-01T22:28:06+0000","dateFinished":"2023-02-01T22:28:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1932"},{"text":"import sqlContext.implicits._\nval ratingsDF = lines.toDF()\n\nratingsDF.printSchema()","user":"anonymous","dateUpdated":"2023-02-01T22:29:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: int]\nroot\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1675290486688_-1435125168","id":"20230201-222806_1104840465","dateCreated":"2023-02-01T22:28:06+0000","dateStarted":"2023-02-01T22:29:22+0000","dateFinished":"2023-02-01T22:29:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1933"},{"text":"val topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\ntopMovieIDs.show()","user":"anonymous","dateUpdated":"2023-02-01T22:30:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  584|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  368|\n|    222|  365|\n|    204|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1675290562614_1177627992","id":"20230201-222922_1442782999","dateCreated":"2023-02-01T22:29:22+0000","dateStarted":"2023-02-01T22:30:25+0000","dateFinished":"2023-02-01T22:30:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1934"},{"text":"ratingsDF.registerTempTable(\"ratings\")","user":"anonymous","dateUpdated":"2023-02-01T22:33:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1675290625392_-1272544949","id":"20230201-223025_1025695095","dateCreated":"2023-02-01T22:30:25+0000","dateStarted":"2023-02-01T22:33:33+0000","dateFinished":"2023-02-01T22:33:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1935"},{"text":"%sql\n\nSELECT * FROM ratings LIMIT 10","user":"anonymous","dateUpdated":"2023-02-01T22:35:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\trating\n50\t5\n172\t5\n133\t1\n242\t3\n302\t3\n377\t1\n51\t2\n346\t1\n474\t4\n265\t2\n"}]},"apps":[],"jobName":"paragraph_1675290931004_-1316377320","id":"20230201-223531_1493004729","dateCreated":"2023-02-01T22:35:31+0000","dateStarted":"2023-02-01T22:35:51+0000","dateFinished":"2023-02-01T22:36:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1938"},{"text":"%sql\nSELECT rating, COUNT(*) as count FROM ratings GROUP BY rating","user":"anonymous","dateUpdated":"2023-02-01T22:37:27+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tcount\n1\t6111\n3\t27145\n5\t21203\n4\t34174\n2\t11370\n"}]},"apps":[],"jobName":"paragraph_1675290951400_1357474294","id":"20230201-223551_1973577828","dateCreated":"2023-02-01T22:35:51+0000","dateStarted":"2023-02-01T22:37:07+0000","dateFinished":"2023-02-01T22:37:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1939"},{"text":"final case class Movie(movieID: Int, title:String)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {val fields = x.split('|'); Movie(fields(0).toInt, fields(1))})\n\nimport sqlContext.implicits._\n\nval moviesDF = lines.toDF()\n\nmoviesDF.show()","user":"anonymous","dateUpdated":"2023-02-01T22:47:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[36] at map at <console>:33\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+--------------------+\n|movieID|               title|\n+-------+--------------------+\n|      1|    Toy Story (1995)|\n|      2|    GoldenEye (1995)|\n|      3|   Four Rooms (1995)|\n|      4|   Get Shorty (1995)|\n|      5|      Copycat (1995)|\n|      6|Shanghai Triad (Y...|\n|      7|Twelve Monkeys (1...|\n|      8|         Babe (1995)|\n|      9|Dead Man Walking ...|\n|     10|  Richard III (1995)|\n|     11|Seven (Se7en) (1995)|\n|     12|Usual Suspects, T...|\n|     13|Mighty Aphrodite ...|\n|     14|  Postino, Il (1994)|\n|     15|Mr. Holland's Opu...|\n|     16|French Twist (Gaz...|\n|     17|From Dusk Till Da...|\n|     18|White Balloon, Th...|\n|     19|Antonia's Line (1...|\n|     20|Angels and Insect...|\n+-------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1675291027585_-1430354416","id":"20230201-223707_386782051","dateCreated":"2023-02-01T22:37:07+0000","dateStarted":"2023-02-01T22:47:52+0000","dateFinished":"2023-02-01T22:48:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1941"},{"text":"moviesDF.registerTempTable(\"titles\")","user":"anonymous","dateUpdated":"2023-02-01T22:48:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1675291322211_-299163645","id":"20230201-224202_1050650483","dateCreated":"2023-02-01T22:42:02+0000","dateStarted":"2023-02-01T22:48:34+0000","dateFinished":"2023-02-01T22:48:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1942"},{"text":"%sql\n \nSELECT t.title,count(*) cnt FROM ratings r JOIN titles t ON r.movieID = t.movieID GROUP BY t.title ORDER BY cnt DESC LIMIT 20","user":"anonymous","dateUpdated":"2023-02-01T22:52:01+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tcnt\nStar Wars (1977)\t584\nContact (1997)\t509\nFargo (1996)\t508\nReturn of the Jedi (1983)\t507\nLiar Liar (1997)\t485\nEnglish Patient, The (1996)\t481\nScream (1996)\t478\nToy Story (1995)\t452\nAir Force One (1997)\t431\nIndependence Day (ID4) (1996)\t429\nRaiders of the Lost Ark (1981)\t420\nGodfather, The (1972)\t413\nPulp Fiction (1994)\t394\nTwelve Monkeys (1995)\t392\nSilence of the Lambs, The (1991)\t390\nJerry Maguire (1996)\t384\nChasing Amy (1997)\t379\nRock, The (1996)\t378\nEmpire Strikes Back, The (1980)\t368\nStar Trek: First Contact (1996)\t365\n"}]},"apps":[],"jobName":"paragraph_1675291713676_1384296683","id":"20230201-224833_1017637209","dateCreated":"2023-02-01T22:48:33+0000","dateStarted":"2023-02-01T22:50:42+0000","dateFinished":"2023-02-01T22:51:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1943"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2023-02-01T22:50:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1675291827234_-1096843349","id":"20230201-225027_92653258","dateCreated":"2023-02-01T22:50:27+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1944","errorMessage":""}],"name":"Playing with MovieLens","id":"2HQJMU7V6","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}